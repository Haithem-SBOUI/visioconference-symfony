{% extends 'base.html.twig' %}

{% block title %}Meeting index{% endblock %}

{% block body %}

    {% include 'shared/navbar.html.twig' %}



    <section class="heading-page header-text" id="top">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h6>Here are our upcoming meetings</h6>
                    <h2>Upcoming Meetings</h2>
                </div>
            </div>
        </div>
    </section>

    <section class="meetings-page" id="meetings">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="filters">
                        <ul>
                            <li class="active" style="font-size: 20px">{{ meetings|length }} Meetings</li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="row grid">
                        {% for meeting in meetings %}
                            <div class="col-md-4">
                                <div class="col-md-11 templatemo-item-col all ">
                                    <div class="meeting-item">
                                        <div class="thumb top-bg">
                                            <div class="price">
                                                <span>to fill</span>
                                            </div>
                                            <a href="meeting-details.html">
                                                <img src="{{ vich_uploader_asset( meeting ) }}" alt="Profile Image">

                                            </a>
                                        </div>
                                        <div class="down-content">
                                            <a class="title" href="meeting-details.html"
                                               style="text-transform: uppercase; display: block; line-height:15px">{{ meeting.title }}</a>

                                            <span class=""
                                                  style="font-size: 14px; color: grey; font-weight: normal">Room code: {{ meeting.roomId }}</span>
                                            <span class="iconify"
                                                  data-icon="line-md:clipboard-arrow-twotone"
                                                  data-width="21"
                                                  style="color: #595959;"></span> </a>
                                            <br>


                                            <div class="mt-3" style="font-size: 15px">
                                                <div class="row">
                                                    <div class="icon-part">
                                                                <span class="iconify" data-icon="uiw:date"
                                                                      data-width="21" data-height="21"></span>
                                                    </div>
                                                    <div class="text-part">
                                                        <td>{{ meeting.dateTime ? meeting.dateTime|date('Y-m-d H:i:s') : '' }}</td>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mt-3">
                                                <div class="row">
                                                    <div class="icon-part">
                                                                <span class="iconify me-2"
                                                                      data-icon="fa-solid:chalkboard-teacher"
                                                                      data-width="21"></span>

                                                    </div>
                                                    <div class="text-part">
                                                        {#                                                                <span> meeting.organizer[0].firstname + " " + meeting.organizer[0].lastname </span> #}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mt-3">
                                                <div class="row">
                                                    <div class="icon-part">
                                                                <span class="iconify"
                                                                      data-icon="fluent:text-description-32-filled"
                                                                      data-width="23"></span>
                                                    </div>
                                                    <div class="text-part">
                                                        {% set descriptionWords = meeting.description|split(' ') %}

                                                        {# Iterate over the first 5 words and display them #}
                                                        {% for word in descriptionWords|slice(0, 9) %}
                                                            {{ word }}
                                                            {% if not loop.last %} {# Add a space after each word, except the last one #} {% endif %}
                                                        {% endfor %}

                                                        {# If there are more than 5 words, add an ellipsis #}
                                                        {% if descriptionWords|length > 9 %} .. {% endif %}
                                                    </div>
                                                </div>


                                                <a class="btn custom-btn1 mt-4" href="{{ path('app_meeting_show', {'id': meeting.id}) }}">
                                                    Show meet details
                                                </a>
                                                <!--                        todo: add if meeting.datetime - 2 hours the link available, else the button disabled and write under it : joining will be available 2 hours before the meet-->
                                                <a class="btn custom-btn1 mt-4" href="{{ path('app_meeting_room', {'roomId': meeting.roomId}) }}">
                                                    Join Room

                                                </a>


                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% else %}
                            <h3>no records found</h3>
                        {% endfor %}
                    </div>
                </div>
                {#                       pagination #}
            </div>
        </div>

    </section>

{% endblock %}